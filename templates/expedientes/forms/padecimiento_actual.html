<!-- Mostrar alerta de Historia Clínica -->
{% if paciente %}
<div class="w-full bg-blue-200 border-blue-500 text-blue-500 rounded-lg p-3 text-center">
  Historia clínica del paciente: {{ paciente.nombre }} {{ paciente.apellido_pat }} {{ paciente.apellido_mat }}
</div>
{% endif %}

<<<<<<< HEAD

    {% if paciente %}
    <div class="w-full bg-red-200 border-red-500 text-red-500 rounded-lg p-3 text-center">
      Historia clinica del paciente: {{ paciente.nombre }} {{ paciente.apellido_pat }} {{ paciente.apellido_mat }}
    </div>
    {% endif %}

    {% if success_msg_padecimiento %}
    <div class="alert alert-success" style="color: green;">
        {{ success_msg_padecimiento }}
    </div>
{% endif %}

{%if error_msg_padecimiento %}
<div class="alert alert-success" style="color: red;">
  {{ error_msg_padecimiento }}
</div>
{% endif %}
    
    <h1 class="text-xl font-bold text-main uppercase">Padecimientos Actuales</h1>
=======
<!-- Alertas de error/success -->
{% if error_msg_padecimiento %}
<div class="w-full bg-red-200 border-red-500 text-red-500 rounded-lg p-3 text-center">
  {{ error_msg_padecimiento }}
</div>
{% endif %}

<h1 class="text-xl font-bold text-main uppercase">Padecimiento Actual</h1>

<!-- Padecimiento Actual -->
<div class="w-full">
  <label for="padecimiento_actual" class="block mb-2 text-sm font-semibold uppercase">Padecimiento Actual <span class="text-red-500">*</span></label>
  <textarea id="padecimiento_actual" name="padecimiento_actual" class="resize-none w-full border-none rounded-md bg-white shadow-sm uppercase" placeholder="Escriba el padecimiento actual">{{ padecimiento.padecimiento_actual|default_if_none:'' }}</textarea>
</div>

<!-- Interrogativo por aparatos y sistemas -->
<div class="w-full space-y-8">
  <label class="block mb-4 font-semibold uppercase">Interrogatorio por Aparatos y Sistemas</label>

  <!-- Piel y Tegumentos -->
  <div class="w-full">
    <label for="piel_tegumentos" class="block mb-2 text-sm font-semibold uppercase">Piel y Tegumentos <span class="text-red-500">*</span></label>
    <textarea id="piel_tegumentos" name="piel_tegumentos" class="resize-none w-full border-none rounded-md bg-white shadow-sm uppercase" placeholder="Describa lo referido por el paciente">{{ padecimiento.piel_tegumentos }}</textarea>
  </div>
>>>>>>> new

  <!-- Cabeza y Cuello -->
  <div class="w-full">
    <label for="cabeza_cuello" class="block mb-2 text-sm font-semibold uppercase">Cabeza y Cuello <span class="text-red-500">*</span></label>
    <textarea id="cabeza_cuello" name="cabeza_cuello" class="resize-none w-full border-none rounded-md bg-white shadow-sm uppercase" placeholder="Describa lo referido por el paciente">{{ padecimiento.cabeza_cuello }}</textarea>
  </div>

  <!-- Torax -->
  <div class="w-full">
    <label for="torax" class="block mb-2 text-sm font-semibold uppercase">Torax <span class="text-red-500">*</span></label>
    <textarea id="torax" name="torax" class="resize-none w-full border-none rounded-md bg-white shadow-sm uppercase" placeholder="Describa lo referido por el paciente">{{ padecimiento.torax }}</textarea>
  </div>

  <!-- Abdomen -->
  <div class="w-full">
    <label for="abdomen" class="block mb-2 text-sm font-semibold uppercase">Abdomen <span class="text-red-500">*</span></label>
    <textarea id="abdomen" name="abdomen" class="resize-none w-full border-none rounded-md bg-white shadow-sm uppercase" placeholder="Describa lo referido por el paciente">{{ padecimiento.abdomen }}</textarea>
  </div>

  <!-- Genitourinario -->
  <div class="w-full">
    <label for="genitourinario" class="block mb-2 text-sm font-semibold uppercase">Genitourinario <span class="text-red-500">*</span></label>
    <textarea id="genitourinario" name="genitourinario" class="resize-none w-full border-none rounded-md bg-white shadow-sm uppercase" placeholder="Describa lo referido por el paciente">{{ padecimiento.genitourinario }}</textarea>
  </div>

  <!-- Músculo Esquelético y Extremidades -->
  <div class="w-full">
    <label for="musculo_extremidades" class="block mb-2 text-sm font-semibold uppercase">Músculo Esquelético y Extremidades <span class="text-red-500">*</span></label>
    <textarea id="musculo_extremidades" name="musculo_extremidades" class="resize-none w-full border-none rounded-md bg-white shadow-sm uppercase" placeholder="Describa lo referido por el paciente">{{ padecimiento.musculo_extremidades }}</textarea>
  </div>   

  <!-- Neurológico -->
  <div class="w-full">
    <label for="neurologico" class="block mb-2 text-sm font-semibold uppercase">Neurológico <span class="text-red-500">*</span></label>
    <textarea id="neurologico" name="neurologico" class="resize-none w-full border-none rounded-md bg-white shadow-sm uppercase" placeholder="Describa lo referido por el paciente">{{ padecimiento.neurologico }}</textarea>
  </div>
</div>

<!-- Notas -->
<div class="w-full">
  <label for="notas_padecimientos" class="block mb-2 text-sm font-semibold uppercase">Notas</label>
  <textarea id="notas_padecimientos" name="notas_padecimientos" class="resize-none w-full border-none rounded-md bg-white shadow-sm uppercase" placeholder="Agregue notas extra en caso de ser necesarias">{{ padecimiento.notas }}</textarea>
</div>

{% csrf_token %}
<!-- Campo oculto para almacenar el ID del paciente -->
<input type="hidden" name="paciente_id" value="{{ paciente.id }}">

<<<<<<< HEAD

    
    <!-- <script>
      document.getElementById("formData_padecimiento_actual").addEventListener("submit", function(event) {
        event.preventDefault(); // Evitar el comportamiento predeterminado del formulario

        // Obtener los datos del formulario
        const formData = new FormData(this);

        /* ========================================
        Campos OBLIGATORIOS para comprobar que 
        todos tengan un valor
        ========================================= */
        const padecimiento_actual = formData.get("padecimiento_actual");
        const piel_tegumentos = formData.get("piel_tegumentos");
        const cabeza_cuello = formData.get("cabeza_cuello");
        const torax = formData.get("torax");
        const abdomen = formData.get("abdomen");
        const genitourinario = formData.get("genitourinario");
        const musculo_extremidades = formData.get("musculo_extremidades");
        const neurologico = formData.get("neurologico");

        // Comprobamos que existan todos los valores de los campos obligatorios
        if(padecimiento_actual && piel_tegumentos && cabeza_cuello && torax && abdomen && genitourinario && musculo_extremidades && neurologico){
        // Enviar los datos utilizando fetch
        fetch("../padecimiento/", {
          method: "POST",
          body: formData
      })
      .then(response => {
          if (response.ok) {
              // La respuesta del servidor fue exitosa
              const Toast = Swal.mixin({
                toast: true,
                position: 'top-end',
                showConfirmButton: false,
                timer: 3000,
                timerProgressBar: true,
                didOpen: (toast) => {
                  toast.addEventListener('mouseenter', Swal.stopTimer)
                  toast.addEventListener('mouseleave', Swal.resumeTimer)
                }
              })
              
              Toast.fire({
                icon: 'success',
                title: 'Datos enviados correctamente'
              })

            /* ========================================
            Limpiar TODOS los campos del formulario 
            (obligatorios y opcionales)
            ========================================= */
            document.getElementById("padecimiento_actual").value = "";
            document.getElementById("piel_tegumentos").value = "";
            document.getElementById("cabeza_cuello").value = "";
            document.getElementById("torax").value = "";
            document.getElementById("abdomen").value = "";
            document.getElementById("genitourinario").value = "";
            document.getElementById("musculo_extremidades").value = "";
            document.getElementById("neurologico").value = "";
            document.getElementById("notas_padecimientos").value = "";


          } else {
            console.log(formData);
              // La respuesta del servidor no fue exitosa
              Swal.fire(
                '¡Error al enviar!',
                'Error al enviar los datos',
                'error'
              )
          }
      })
      .catch(error => {
          // Ocurrió un error en la solicitud
          // Puedes manejar el error de acuerdo a tus necesidades
          console.log(error);
          Swal.fire(
            '¡Error al enviar!',
            `Error en la solicitud, ${error}`,
            'error'
          )
      });

        }else{
          Swal.fire(
            '¡Error al enviar!',
            'Rellena todos los campos obligatorios (*)',
            'error'
          )
        }
    });
    </script> -->
  </body>
</html>
=======
<!-- Botones de formulario -->
<div class="flex justify-center gap-10 mt-20">
  <a href="/" class="w-3/12 py-3 border-none bg-rojo focus:ring-2 focus:ring-offset-2 focus:ring-rojo text-center rounded-lg text-white font-semibold">Cancelar</a>
  <button onclick="mostrarAlerta()" type="submit" class="w-3/12 py-3 border-none bg-main focus:ring-2 focus:ring-offset-2 focus:ring-main text-center rounded-lg text-white font-semibold">Enviar Datos</button>
</div>
>>>>>>> new
